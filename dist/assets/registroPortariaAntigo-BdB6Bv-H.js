import{r,j as e}from"./mui-_wqMIBiI.js";import{T as s,s as m,c as z}from"./PortariaRoutes-CKRfdjmf.js";import{j as Z,b as j,L as $,d as H,n as f}from"./index-BYSqOyoE.js";import{D as J,B as Q,f as W,b as X}from"./menuConfig-C5Fu2Emn.js";import"./react-OvXVS5lI.js";import"./BotaoVoltar-CxvXsGU3.js";import"./NotFund-CATxkBTh.js";const i=H.span`
  color: red;
  `,Y=[{id:1,nome:"Somente Motorista",codigo:"PRES"},{id:2,nome:"Motorista e Passageiros",codigo:"DIR"}];function ce(){const{register:l,handleSubmit:b,formState:{errors:a},reset:p,watch:C}=Z({defaultValues:{globalAtivo:"false"}}),[n,S]=r.useState(null),[g,u]=r.useState(0),[E,A]=r.useState([]),[v,I]=r.useState([]),[R,O]=r.useState([]),y=j(),[P,T]=r.useState(!1),w=y?.permissoes||[],[F,q]=r.useState([]),N=w.includes("GERENCIAR_USUARIOS"),L=async()=>{const o=await W.lista();o?.filial&&O(o?.filial)},h=C("tipoAcesso"),B=o=>{S(o)},[M,t]=r.useState(!1),D=async o=>{t(!0);const d=j();if(o.typeMethod="NAO_VISITANTE",o.descricao||delete o.descricao,n!=null){o.criadorId=d?.id,h?.toUpperCase()==="RECORRENTE TEMPORARIO"||delete o.dataAcesso;const x=await X.salvaRegistro(o,n);x&&(t(!1),f(x.msg,"success"),p(),u(K=>K+1))}else t(!1),f("Selecione uma imagem","error")},k=()=>{u(o=>o+1),T(!1),p()},V=r.useRef(null),c=(o,d)=>{o.key==="Enter"&&d?.current?.focus()},U=async()=>{const o=await m.lista();o?.tipoPessoa&&A(o?.tipoPessoa)},_=async()=>{const o=await m.recorrecia();o.recorrencia&&I(o.recorrencia)},G=async()=>{const o=await z.blocos();o.blocos&&q(o?.blocos)};return r.useEffect(()=>{U(),_(),L(),G()},[]),e.jsx(e.Fragment,{children:e.jsxs(s.container_principal,{children:[e.jsxs(s.container,{children:[e.jsx(s.titulo,{children:"Novo Pedido de Acesso"}),e.jsxs(s.pedidos,{children:[e.jsxs(s.FormSub,{children:[e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Placa ",e.jsx(i,{children:"*"})]}),e.jsx(s.Campos,{hasError:!!a.placaVeiculo,type:"text",autoComplete:"current-password",placeholder:"Placa do Veiculo",...l("placaVeiculo",{required:"Placa E obrigatorio",pattern:{value:/^([^0-9][^0-9][^0-9][0-9][A-Za-z0-9][0-9][0-9])/,message:"Formato de placa inválido. Ex: ABC1234 ou ABC1D23"}}),onKeyDown:o=>{c(o,V)}}),e.jsx(s.Erros,{children:a.placaVeiculo&&e.jsx("p",{children:a.placaVeiculo.message})})]}),e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Nome ",e.jsx(i,{children:"*"})]}),e.jsx(s.Campos,{hasError:!!a.nomeCompleto,placeholder:"Nome Completo",type:"text",autoComplete:"current-password",...l("nomeCompleto",{required:"Nome e obrigatória",minLength:{value:10,message:"Mínimo 10 caracteres"}}),onKeyDown:o=>c(o)}),e.jsx(s.Erros,{children:a.nomeCompleto&&e.jsx("p",{children:a.nomeCompleto.message})})]}),e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Numero de Telefone ",e.jsx(i,{children:"*"})]}),e.jsx(s.Campos,{hasError:!!a.nomeCompleto,placeholder:"(99) 99999-9999",type:"tel",autoComplete:"current-password",...l("numeroTelefone",{required:"O telefone é obrigatório.",pattern:{value:/^(\+?55\s?)?(\(?\d{2}\)?\s?)?(9?\d{4}-?\d{4})$/,message:"Formato de telefone inválido. Ex: (98) 9809-9999 ou 98980999977"}}),onKeyDown:o=>c(o)}),e.jsx(s.Erros,{children:a.numeroTelefone&&e.jsx("p",{children:a.numeroTelefone.message})})]}),e.jsxs(s.leftArea,{children:[e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Filial ",e.jsx(i,{children:"*"})]}),e.jsxs(s.SelectItens,{...l("filial",{required:"Selecione uma filial"}),children:[e.jsx(s.Options,{value:"",children:"Selecione"}),R.flatMap(o=>e.jsxs(s.Options,{value:o?.numeroFilial,children:[o?.numeroFilial," - ",o?.nome]},o?.id))]}),a.filial&&e.jsx(s.Erros,{children:e.jsx("p",{children:a.filial.message})})]}),N&&e.jsxs(s.CamposInput,{children:[e.jsx(s.label,{children:"Global?"}),e.jsxs(s.labelCheck,{style:{display:"flex"},children:[e.jsx(s.checkbox,{type:"radio",value:"true",...l("globalAtivo")}),e.jsx("small",{children:"Sim"})]}),e.jsxs(s.labelCheck,{children:[e.jsx(s.checkbox,{type:"radio",value:"false",...l("globalAtivo")}),e.jsx("small",{children:"Não"})]})]})]}),e.jsxs(s.Select,{children:[e.jsxs(s.leftArea,{children:[e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Tipo de Pessoa ",e.jsx(i,{children:"*"})]}),e.jsxs(s.SelectItens,{...l("tipPessoa",{required:"Selecione o tipo de Pessoa"}),children:[e.jsx(s.Options,{value:"",children:"Selecione"}),E.flatMap(o=>e.jsx(s.Options,{value:o?.nome,children:o?.nome}))]}),a.tipPessoa&&e.jsx(s.Erros,{children:e.jsx("p",{children:a.tipPessoa.message})})]}),e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Bloco",e.jsx(i,{children:"*"})]}),e.jsxs(s.SelectItens,{...l("bloco",{required:"Selecione o bloco"}),children:[e.jsx(s.Options,{value:"",children:"Selecione"}),F.flatMap(o=>e.jsx(s.Options,{value:o?.nome.toUpperCase(),children:o?.nome.toUpperCase()}))]}),a.bloco&&e.jsx(s.Erros,{children:e.jsx("p",{children:a.bloco.message})})]})]}),e.jsxs(s.leftArea,{children:[e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Recorrência do Acesso ",e.jsx(i,{children:"*"})]}),e.jsxs(s.SelectItens,{...l("tipoAcesso",{required:"Selecione o Tipo de acesso"}),children:[e.jsx(s.Options,{value:"",children:"Selecione"}),v.map(o=>e.jsx(s.Options,{value:o?.nome.toLowerCase(),children:o?.nome}))]}),a.tipoAcesso&&e.jsx(s.Erros,{children:e.jsx("p",{children:a.tipoAcesso.message})})]}),e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Ocupação Liberada ",e.jsx(i,{children:"*"})]}),e.jsxs(s.SelectItens,{...l("ocupacaoLiberada",{required:"Selecione uma ocupaçao"}),children:[e.jsx(s.Options,{value:"",children:"Selecione"}),Y.flatMap(o=>e.jsx(s.Options,{value:o.nome,children:o.nome},o.id))]}),a.ocupacaoLiberada&&e.jsx(s.Erros,{children:e.jsx("p",{children:a.ocupacaoLiberada.message})})]})]}),h?.toUpperCase()==="RECORRENTE TEMPORARIO"&&e.jsxs(s.CamposInput,{children:[e.jsxs(s.label,{children:["Data ",e.jsx(i,{children:"*"})]}),e.jsx(s.Campos,{hasError:!!a.dataAcesso,placeholder:"data",type:"date",autoComplete:"current-password",...l("dataAcesso",{required:"A data é obrigatória para acesso recorrente temporário"}),onKeyDown:o=>c(o)}),a.dataAcesso&&e.jsx(s.Erros,{children:e.jsx("p",{children:a.dataAcesso.message})})]}),e.jsxs(s.CamposInput,{children:[e.jsx(s.label,{children:"OBS "}),e.jsx(s.TextArea,{...l("descricao")})]})]}),e.jsxs(s.label,{children:["IMG visitante",e.jsx(i,{children:"*"})]}),e.jsx(J,{onFileSelect:B,titulo:"Clique ou arraste outra imagem para substituir",resetSignal:g}),n&&e.jsxs("p",{children:["Arquivo selecionado: ",n.name]})]}),e.jsxs(s.btnDivider,{children:[e.jsx(s.BtnLogin,{disabled:M,onClick:b(D),children:"Enviar Pedido"}),e.jsx(Q,{click:k,nome_btn:"red",isvalid:!0,children:"Limpar"})]})]})]}),P&&e.jsx($,{})]})})}export{ce as default,Y as ocupacoesLiberada};
